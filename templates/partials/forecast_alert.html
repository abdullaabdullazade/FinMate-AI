<!-- Forecast Alert Component -->
{% if forecast and forecast.sufficient_data %}
{% if forecast.danger_level == 'danger' or forecast.danger_level == 'warning' %}
<div
    class="forecast-alert mb-6 {% if forecast.danger_level == 'danger' %}alert-danger{% else %}alert-warning{% endif %}">
    <div class="flex items-start gap-4">
        <div class="alert-icon">
            {% if forecast.danger_level == 'danger' %}
            ‚ö†Ô∏è
            {% else %}
            ‚ö°
            {% endif %}
        </div>

        <div class="flex-1">
            <h3 class="font-bold text-lg mb-2">
                {% if forecast.danger_level == 'danger' %}
                Danger: Budget Overrun Predicted!
                {% else %}
                Warning: Approaching Budget Limit
                {% endif %}
            </h3>

            <div class="space-y-2">
                <p>
                    <strong>Current Spending:</strong> {{ "%.2f"|format(forecast.current_spending) }} AZN
                    ({{ "%.1f"|format(forecast.budget_used_percentage) }}% of budget)
                </p>
                <p>
                    <strong>Projected End-of-Month:</strong> {{ "%.2f"|format(forecast.projected_total) }} AZN
                </p>

                {% if forecast.danger_level == 'danger' %}
                <p class="font-bold">
                    üìâ Expected to overspend by {{ "%.2f"|format(forecast.overspend_amount) }} AZN
                </p>
                {% endif %}

                <p class="mt-3 p-3 bg-white bg-opacity-50 rounded-lg">
                    üí° <strong>Recommended:</strong> Limit spending to
                    <span class="font-bold text-lg">{{ "%.2f"|format(forecast.suggested_daily_limit) }} AZN/day</span>
                    for the remaining {{ forecast.days_remaining }} days
                </p>
            </div>

            <div class="mt-4 flex gap-2">
                <a href="/settings" class="btn-alert">
                    Adjust Budget
                </a>
                <button onclick="this.closest('.forecast-alert').remove()" class="btn-dismiss">
                    Dismiss
                </button>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endif %}

<style>
    .forecast-alert {
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .alert-danger {
        background: linear-gradient(135deg, #FEE2E2 0%, #FCA5A5 100%);
        border: 2px solid #EF4444;
        color: #7F1D1D;
    }

    .alert-warning {
        background: linear-gradient(135deg, #FEF3C7 0%, #FCD34D 100%);
        border: 2px solid #F59E0B;
        color: #78350F;
    }

    .alert-icon {
        font-size: 32px;
        line-height: 1;
    }

    .btn-alert {
        background: rgba(0, 0, 0, 0.2);
        color: inherit;
        padding: 8px 16px;
        border-radius: 6px;
        font-weight: 600;
        text-decoration: none;
        transition: background 0.2s;
    }

    .btn-alert:hover {
        background: rgba(0, 0, 0, 0.3);
    }

    .btn-dismiss {
        background: transparent;
        border: 2px solid currentColor;
        color: inherit;
        padding: 6px 16px;
        border-radius: 6px;
        font-weight: 600;
        cursor: pointer;
        transition: background 0.2s;
    }

    .btn-dismiss:hover {
        background: rgba(0, 0, 0, 0.1);
    }
</style>