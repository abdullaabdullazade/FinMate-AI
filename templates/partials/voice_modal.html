<!-- Voice Command Modal -->
<div id="voice-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6">
    <!-- Backdrop -->
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closeVoiceModal()"></div>
    
    <!-- Modal Content -->
    <div class="relative glass-card rounded-3xl p-4 sm:p-6 md:p-8 max-w-md w-full mx-auto shadow-2xl transform transition-all">
        <!-- Close Button -->
        <button id="close-voice-modal" 
            class="absolute top-3 right-3 sm:top-4 sm:right-4 w-8 h-8 sm:w-10 sm:h-10 flex items-center justify-center rounded-full bg-white/10 hover:bg-white/20 text-white/80 hover:text-white transition z-10">
            <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>

        <!-- Header -->
        <div class="text-center mb-4 sm:mb-6">
            <div class="inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 mb-3 sm:mb-4 shadow-lg">
                <svg class="w-8 h-8 sm:w-10 sm:h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
                </svg>
            </div>
            <h2 class="text-xl sm:text-2xl font-bold text-white mb-1">
                S…ôsli ∆èmr
            </h2>
            <p class="text-xs sm:text-sm text-white/70">AI s…ôsi dinl…ôyir</p>
        </div>

        <!-- Language Selector -->
        <div class="mb-4 sm:mb-6">
            <label class="block text-xs sm:text-sm font-medium text-white/80 mb-2">Dil se√ßin</label>
            <select id="voice-language" 
                class="w-full px-3 sm:px-4 py-2 sm:py-2.5 bg-white/10 border border-white/20 rounded-xl text-white text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                <option value="az" class="bg-gray-900">üá¶üáø Az…ôrbaycan</option>
                <option value="en" class="bg-gray-900">üá∫üá∏ English</option>
                <option value="ru" class="bg-gray-900">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
            </select>
        </div>

        <!-- Status Text -->
        <p id="voice-status" class="text-center text-sm sm:text-base text-white/90 mb-4 sm:mb-6 min-h-[24px]">
            Hazƒ±ram
        </p>

        <!-- Record Button -->
        <div class="flex flex-col items-center gap-4 sm:gap-6 mb-4 sm:mb-6">
            <button id="record-btn" class="voice-record-btn group">
                <svg class="w-12 h-12 sm:w-16 sm:h-16 text-white group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
                </svg>
            </button>

            <!-- Stop Button (hidden initially) -->
            <button id="stop-btn"
                class="hidden bg-gradient-to-r from-red-500 to-red-600 text-white px-6 sm:px-8 py-2.5 sm:py-3 rounded-xl hover:from-red-600 hover:to-red-700 transition font-semibold text-sm sm:text-base shadow-lg">
                <span class="flex items-center gap-2">
                    <svg class="w-4 h-4 sm:w-5 sm:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 10h6v4H9z"></path>
                    </svg>
                    Dayandƒ±r
                </span>
            </button>

            <!-- Loading Spinner -->
            <div id="loading-spinner" class="hidden">
                <div class="animate-spin rounded-full h-12 w-12 sm:h-16 sm:w-16 border-4 border-white/20 border-t-purple-500" aria-label="Y√ºkl…ônir">
                </div>
            </div>
        </div>

        <!-- Result Display -->
        <div id="voice-result" class="mt-4 sm:mt-6"></div>

        <!-- Help Text -->
        <div class="bg-white/5 rounded-xl p-3 sm:p-4 mt-4 sm:mt-6 border border-white/10">
            <p class="text-xs sm:text-sm text-white/70">
                <strong class="text-white/90">N√ºmun…ôl…ôr:</strong><br>
                üá¶üáø "Taksi √º√ß√ºn 10 manat x…ôrcl…ômi≈ü…ôm"<br>
                üá∫üá∏ "Spent 15 AZN on lunch"<br>
                üá∑üá∫ "–ü–æ—Ç—Ä–∞—Ç–∏–ª 20 –º–∞–Ω–∞—Ç –Ω–∞ –∫–æ—Ñ–µ"
            </p>
        </div>
    </div>
</div>

<style>
    .voice-record-btn {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        background: linear-gradient(135deg, #ec407a 0%, #ab47bc 100%);
        border: 3px solid rgba(255, 255, 255, 0.3);
        cursor: pointer;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 10px 30px rgba(236, 64, 122, 0.4), 0 0 0 0 rgba(236, 64, 122, 0.5);
    }

    @media (min-width: 640px) {
        .voice-record-btn {
            width: 120px;
            height: 120px;
        }
    }

    .voice-record-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 15px 40px rgba(236, 64, 122, 0.6), 0 0 0 0 rgba(236, 64, 122, 0.7);
    }

    .voice-record-btn:active {
        transform: scale(0.95);
    }

    .voice-record-btn.recording {
        animation: pulse-scale 1.5s ease-in-out infinite;
        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        border-color: rgba(255, 255, 255, 0.5);
    }

    /* Pulse rings - only visible when recording */
    .voice-record-btn.recording::before,
    .voice-record-btn.recording::after {
        content: '';
        position: absolute;
        width: 100%;
        height: 100%;
        border: 3px solid #ef4444;
        border-radius: 50%;
        animation: pulse-ring 2s ease-out infinite;
        opacity: 0;
    }

    .voice-record-btn.recording::after {
        animation-delay: 0.5s;
    }

    @keyframes pulse-scale {
        0%, 100% {
            transform: scale(1);
        }
        50% {
            transform: scale(1.08);
        }
    }

    @keyframes pulse-ring {
        0% {
            transform: scale(0.95);
            opacity: 0.8;
        }
        100% {
            transform: scale(1.6);
            opacity: 0;
        }
    }

    .success-result {
        background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(5, 150, 105, 0.2) 100%);
        border: 2px solid #10b981;
        border-radius: 16px;
        padding: 16px;
        color: #ffffff;
        animation: slideInUp 0.4s ease-out;
    }

    .success-result p {
        margin: 4px 0;
    }

    .xp-badge {
        background: linear-gradient(135deg, #ec407a 0%, #ab47bc 100%);
        color: white;
        padding: 6px 12px;
        border-radius: 20px;
        display: inline-block;
        margin-top: 8px;
        font-weight: bold;
        font-size: 0.875rem;
        box-shadow: 0 4px 12px rgba(236, 64, 122, 0.4);
    }

    .error-result {
        background: linear-gradient(135deg, rgba(239, 68, 68, 0.2) 0%, rgba(220, 38, 38, 0.2) 100%);
        border: 2px solid #ef4444;
        border-radius: 16px;
        padding: 16px;
        color: #ffffff;
        animation: slideInUp 0.4s ease-out;
    }

    @keyframes slideInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Mobile optimizations */
    @media (max-width: 640px) {
        #voice-modal .glass-card {
            padding: 1.5rem;
        }
        
        .voice-record-btn {
            width: 90px;
            height: 90px;
        }
    }
</style>